---
title: "Restoration Effects on Water Quality at the North Campus Open Space"
format: html
editor: visual
---

## Introduction

Estuaries are fragile ecosystems that provide a habitat for many organisms including threatened and endangered species. Temporary open closed estuaries (TOCE's) are especially vulnerable to a changing environment. TOCE's remain disconnected from the ocean during the dry season; then they fill up during the beginning of the wet season until there is enough water to overtop a sand berm causing a breaching event where the estuary water flows into the ocean. After the sand is scoured away the estuary may remain tidal for up to a few months depending on how high or low the tide is. During low tide the berm may begin to build up causing the estuary to close again.

Understanding water quality of a TOCE is important because it releases nutrients to the ocean and also receives nutrients from the ocean. Nitrogen and Phosphorus are two nutrients of concern found in wetlands due to urban and agricultural runoff (Glandon et al., n.d.; Roberts & Prince, 2010) especially during storm events (Royer et al., 2006). Ammonium (NH4) is a form of nitrogen that is bioavailable and toxic to organisms, therefore it is often measured in wetlands (Clarke & Baldwin, 2002; Sikora et al., 1995; Zhu & Sikora, 1995).

Golf courses often use reclaimed water which can have high concentrations of ammonia (Drewes, 2001; Hu et al., 2016). This is beneficial to the golf courses because the ammonia rich water can help fertilize the course, however the runoff that is not absorbed by vegetation may be toxic to aquatic organisms. Irrigation runoff also causes more frequent flow which reduces the potential for denitrification and phosphorus settling which occurs in stagnant water (Knowles-1982-Denitrification, n.d.; Martínez-Espinosa et al., 2021).

Wetlands and wetland features such as bioswales and riparian zones are a natural management practice capable of removing nutrients (Rickard, 2021). The amount of nutrients removed by a wetland varies greatly with 131% standard deviation in Gonzalez-Meler et al., 2013's review of wetland efficiency. This could be due to the variation of wetland structures in the studies, the fact that wetlands could have sediment release during large storms and the variation of input to constructed wetlands. For example, many wetland studies are based on waste water treatment plants which have a very high nutrient input, therefore even if a lot of nutrients is removed (grams) the efficiency (%) may still be low. Wetlands can remove nitrogen from the water column by the process of denitrification which breaks the N and O bond in an anoxic environment and emits gaseous O2 and N2 (Knowles, n.d.; Martínez-Espinosa et al., 2021) both which are not harmful and already exist in the air we breathe. Ammonium can also be decomposed and emitted as gaseous ammonia (NH3).

Phosphorus is a positively charged ion that easily bonds to charged sediment particles such as clay and silt (Vidon et al., 2010). Though Phosphorus cannot be removed from the wetland through gaseous release, it easily bonds with sediment to become particulate phosphorus. Particulate phosphorus is not bioavailable to aquatic organisms and may settle to the bottom of the wetland rather than being discharged into the ocean.

## Objective

There are two main goals of this report. **1.** To compare the effect of restoration on nutrient concentrations over time. **2.** To compare nutrient concentrations across space of the restored wetland.

## Methods

### Site Description

North campus open space (formerly ocean meadows golf course) is a 136 acre temporary open closed estuary (TOCE) wetland with restored native grassland, coastal sage scrub, riparian, and vernal pools. The land was operated as a golf course from 1965- 2013. The restoration efforts of North Campus Open Space, began in February 2017 and continues to the present day. Water quality from this estuary is assessed from pre-restoration golf course channel sampling, and in post restoration wetland sampling. The natural wetland was filled in in 1965 to create the golf course and it was re-graded in 2017 to remove the fill from the estimated location of the wetland which was deposited to create the mesa area of the preserve.

![](Figures/images/golfcourse_nozoom.png)

![](Figures/images/Sample%20locations.png)

**Figure 1.** Top: Pre-restoration Ocean Meadows golf course (2005). Bottom: Post restoration North Campus Open Space (2024) with sampling locations. Venoco Bridge was sampled both pre and post restoration while Phelps Creek, Devereux Creek and Whittier Drive Storm drain were only sampled post restoration.

### Sample Collection and Analysis

Pre-restoration data was collected through the Santa Barbara long term ecological research (LTER). Samples for pre-restoration were collected at what is now Venoco bridge with an ISCO sampler in the years 2003-2011. Samples were collected at varying intervals. The methods and metadata for this project can be found at https://sbclter.msi.ucsb.edu/data/catalog/package/?package=knb-lter-sbc.6. For this study only samples that have at least 0.1 inch of rain were used.

Post restoration data was colected between 2017-2022 by the UCSB Cheadle Center.Data is publically available on Dryad (doi:10.25349/D9VG9J). Post restoration samples were only collected during storm events. To ensure the post restoration data is only representative of storm events we also make sure there was at least 0.1 inches of rain within 24 hours before or after the sample was taken.For post restoration samples were taken at 4 sites, 3 upstream and 1 downstream. Samples for Venoco, Whittier, and Phelps are taken using an ISCO sampler while Devereux creek samples were collected with a grab sample. samples were immediately refrigerated and filtered within 24 hours of collection. Samples stored in HDPE bottles and frozen until shipment for analysis was possible. Samples were send to the UCSB marine science institute analytic laboratory for nutrient analysis of NO3 + NO2, PO4, and NH4 with a precision of +/-5%.

### Rainfall Data

Rainfall was collected from NOAA station CRND0103-2021-CA_Santa_Barbara_11_W from 2008- 2022. All NOAA daily rainfall data are calculated over the station's 24-hour local standard time day. County rainfall was used in 2004-2008 before the NOAA station was established https://www.countyofsb.org/3407/Daily-Monthly-Rainfall. Primary station #440- Goleta Fire Station was used for 2004-2008 rainfall data. All county data is recorded as of 8am for the previous 24 hours. We made the decision to combine the two data sets in our efforts to use the best data available at the time. We recognize that using different stations may introduce some error, but since the main point of this research is not on rainfall quantity, but rather just knowing when there is rainfall to interpret samples, we accepted this error. County data reports less rainfall than the NOAA station on average.

## Results

### Spatial variation in NCOS wetland nutrients

Whittier, Phelps and Devereux all flow into the Venoco sampling site. We grouped the downstream sites (Devereux, Phelps and Whittier) and compared to the upstream site (Venoco) to see if there is a statistical difference. We used the mann whitney u test for non parametric, and not equally distributed data. Our results show that Phosphate and Nitrate are significantly lower at the downstream site than they are at the upstream sites (P-value \< 0.005). This indicates that denitrification and phosphate settling could be happening in the NCOS wetland therefore reducing the nutrient concentration that flows out into the ocean. Ammonia was not significantly different between upstream and downstream sites and the mean upstream concentration is higher than the mean downstream concentration (Table 1).

```{=html}
<table>


Nutrient       Upstream Median   Downstream Median     P-value
-------------  ---------------   ------------------    --------
Phosphate          13.2             10.3                 0.002
Nitrate          63.7               28.6                   0.002
Ammonium          4.0               6.4                   0.225

</table>
```
**Table 1.** Median Nutrient concentration of Upstream (Phelps Creek, Whittier Creek and Devereux Creek) and Downstream (Venoco Bridge). P-value is from the mann whitney u test for non parametric data.

```{r,echo=FALSE,warning=FALSE,message=FALSE}
library(readxl)
library(ggplot2)
library(dplyr)
library(readxl)
library(plotly)
library(tidyr)
library(ggpubr)
#Upload and format new nutrient data from 2017-2022
new_Dev<-read.csv("Data/nutrients/Nutrients_2018-2022.csv",strip.white = TRUE)
new_Dev$Sample.Date<-as.Date(new_Dev$Sample.Date,format="%m/%d/%Y")
colnames(new_Dev)[2]<-"Date"
new_Dev$Environment<-"Wetland" #naming environment for later merging
NCOS_All<-new_Dev
#create date time and Year
NCOS_All$Datetime<-as.POSIXct(paste0(NCOS_All$Date," ",NCOS_All$Time),format="%Y-%m-%d %H:%M")
getYearQuarter <- function(x,firstMonth=10,fy.prefix='WY',
   quarter.prefix='Q',sep='-',level.range=c(min(x), max(x)) ) {
  if(level.range[1] > min(x) | level.range[2] < max(x)) {
    warning(paste0('The range of x is greater than level.range. Values ',
                   'outside level.range will be returned as NA.'))
  }
  quarterString <- function(d) {
    year <- as.integer(format(d, format='%Y'))
    month <- as.integer(format(d, format='%m'))
    y <- ifelse(firstMonth > 1 & month >= firstMonth, year+1, year)
    q <- cut( (month - firstMonth) %% 12, breaks=c(-Inf,2,5,8,Inf),
              labels=paste0(quarter.prefix, 1:4))
    return(paste0(fy.prefix, substring(y,3,4)))
  }
  vals <- quarterString(x)
  levels <- unique(quarterString(seq( as.Date(format(level.range[1], '%Y-%m-01')),
    as.Date(format(level.range[2], '%Y-%m-28')), by='month')))
  return(factor(vals, levels=levels, ordered=TRUE))
} 
NCOS_All$wtr_yr<-getYearQuarter(NCOS_All$Date,firstMonth = 10)
#Create better location labels
NCOS_All<-NCOS_All[NCOS_All$Site!="Blank"&NCOS_All$Site!="COPR",]
NCOS_All<- within(NCOS_All, Site[Site == "Phelps Creek (Marymount)"] <- 'Phelps')
NCOS_All<- within(NCOS_All, Site[Site == "Whittier Stormdrain"] <- 'Whittier')
NCOS_All<- within(NCOS_All, Site[Site == "Venoco Bridge"] <- 'Venoco')
NCOS_All<- within(NCOS_All, Site[Site == "Devereux Creek (Ellwood)"] <- 'Devereux')
```


```{r,echo=FALSE,warning=FALSE, message=FALSE}
#Add rain to plotly graph
NOAA_Rain<-read.csv("Data/Rain/NOAA_2008-2011_2017-2022.csv")
NOAA_Rain<-NOAA_Rain[NOAA_Rain$P_DAILY_CALC>-1,]
NOAA_Rain$LST_DATE<-format(NOAA_Rain$LST_DATE,format="%Y%m%d")
NOAA_Rain$LST_DATE<-as.Date(NOAA_Rain$LST_DATE,format="%Y%m%d")
NOAA_Rain<-NOAA_Rain[,c(3,11)]

colnames(NOAA_Rain)[1]<-"Date"
NOAA_Rain_Wetland<-NOAA_Rain[NOAA_Rain$Date>="2017-09-12",]
NOAA_Rain_Wetland$Site<-"Venoco"
NCOS_All_Daily<-aggregate(cbind(Phosphate.um,Nitrite.Nitrate.um,Ammonia.um)~Date+Site+wtr_yr,NCOS_All,FUN=mean)

NCOS_plusRain<-merge(NCOS_All_Daily,NOAA_Rain_Wetland,by=cbind("Date","Site"),all.x=TRUE)
NCOS_plusRain$rain_cm<-NCOS_plusRain$P_DAILY_CALC*0.1
```

```{r, echo=FALSE,warning=FALSE,message=FALSE}
b<-ggplot(NCOS_plusRain)+geom_boxplot(outlier.shape = NA,aes(x=Site,y=Phosphate.um))+
  geom_jitter(aes(x=Site,y=Phosphate.um,color=wtr_yr))+theme_bw()+theme(legend.position = "none")

c<-ggplot(NCOS_plusRain)+geom_boxplot(outlier.shape = NA,aes(x=Site,y=Nitrite.Nitrate.um))+
  geom_jitter(aes(x=Site,y=Nitrite.Nitrate.um,color=wtr_yr))+theme_bw()+theme(legend.position = "none")

d<-ggplot(NCOS_plusRain)+geom_boxplot(outlier.shape = NA,aes(x=Site,y=Ammonia.um))+
  geom_jitter(aes(x=Site,y=Ammonia.um,color=wtr_yr))+theme_bw()+theme(legend.position = "none")

p3 <- ggplot(NCOS_plusRain, aes(x = Phosphate.um, y = Ammonia.um, color = wtr_yr))+
  geom_point()+lims(x = c(0,0), y = c(0,0))+ theme_void()+
  theme(legend.position = c(0.5,0.5),
        legend.key.size = unit(0.65, "cm"),
        legend.text = element_text(size =  12),
        legend.title = element_text(size = 15, face = "bold"))+
  guides(colour = guide_legend(override.aes = list(size=8),ncol=2))


ggarrange(b,c,d,p3, ncol=2, nrow=2)


```

**Figure 2.** Nutrient concentration of the 4 sampling locations shown in figure 1. during the 6 water years of post restoration sampling.

#### Wetland removal efficiency

Here we determined the removal factor for each wetland based on the upstream and downstream sampling points (Figure 1). The Of the 253 unique dateties that we took samples 41 had samples taken at the same time for Devereux, Venoco and Whittier storm drain. Only sample that had these three sites plus a Devereux creek sample taken that day were used for this analysis. Devereux creek was sampled via grab samples rather than isco samples, so the sample timing is different than the other three sites. Rather the daily average was used for the devereux creek site.

County subwatersheds along with digital elevation models were used to determine what proportion each subwatershed contributes to the NCOS wetland. Our estimates show that That Devereux sampling represents 41% of the watershed, Devereux creek represents 35%, Whittier represents 5% and 18% of the watershed is between the sampling sites where the subwatersheds merge before reaching Venoco. Of the 82% of the watershed that has been sampled we multiply each sampling location by the proportion of the watershed that it is estimated to represent and add the 3 sampling site proportion together to estimate the combined nutrient export to Venoco bridge. We analysed the data and estimate the removal fraction for each nutrients.

```{r,echo=FALSE,warning=FALSE}
NCOS_All<-NCOS_All[NCOS_All$Notes!="cracked vial",]
#subdivide into each nutrient
NCOS_All_P<-NCOS_All[,c(1,4,13)]
NCOS_All_P<-na.omit(NCOS_All_P)
NCOS_All_N<-NCOS_All[,c(1,5,13)]
NCOS_All_N<-na.omit(NCOS_All_N)
NCOS_All_A<-NCOS_All[,c(1,6,13)]
NCOS_All_A<-na.omit(NCOS_All_A)
Phosphorus<- NCOS_All_P  %>%
  group_by(Datetime) %>%
  pivot_wider(names_from = Site, 
              values_from = Phosphate.um,
              values_fn = mean)

Phosphorus<-as.data.frame(Phosphorus)
#seperate out Devereux
dev<-Phosphorus[,c(1,5)]
dev<-na.omit(dev)
dev$Date<-as.Date(dev$Datetime)
dev_daily<-aggregate(Devereux~Date,dev,FUN=mean)
#remove devereux samples

Phosphorus<-Phosphorus[,1:4]
Phosphorus<-na.omit(Phosphorus)
Phosphorus$Date<-as.Date(Phosphorus$Datetime)
#Bring Phosphorus back in
Phosphorus_remerge<-merge(Phosphorus,dev,by="Date",all.x=TRUE)
Phosphorus_remerge<-Phosphorus_remerge[,c(1,3:5,7)]
Phosphorus_remerge<-na.omit(Phosphorus_remerge)
Phosphorus_remerge$Phelps_proportion<-Phosphorus_remerge$Phelps*0.51
Phosphorus_remerge$Whittier_proportion<-Phosphorus_remerge$Whittier*0.08
Phosphorus_remerge$Devereux_proportion<-Phosphorus_remerge$Devereux*0.42
Phosphorus_remerge$proportional_nutrients<-Phosphorus_remerge$Phelps_proportion+Phosphorus_remerge$Whittier_proportion+Phosphorus_remerge$Devereux_proportion
Phosphorus_remerge <- Phosphorus_remerge %>%
  mutate(
    rpd = (abs(proportional_nutrients-Venoco) / ((Venoco + proportional_nutrients) / 2)) * 100,
    direction = ifelse(proportional_nutrients>Venoco , "positive", "negative"),
    rpd = ifelse(direction == "negative", -rpd, rpd)
  ) %>%
  select(-direction)  # Optionally remove the direction column if not needed

mean(Phosphorus_remerge$rpd)
##37 percent removal of phosphorus


#nitrogen
Nitrogen<- NCOS_All_N  %>%
  group_by(Datetime) %>%
  pivot_wider(names_from = Site, 
              values_from = Nitrite.Nitrate.um,
              values_fn = mean)

Nitrogen<-as.data.frame(Nitrogen)
#seperate out Devereux
dev<-Nitrogen[,c(1,5)]
dev<-na.omit(dev)
dev$Date<-as.Date(dev$Datetime)
dev_daily<-aggregate(Devereux~Date,dev,FUN=mean)
#remove devereux samples
Nitrogen<-Nitrogen[,1:4]
Nitrogen<-na.omit(Nitrogen)
Nitrogen$Date<-as.Date(Nitrogen$Datetime)
#Bring Nitrogen back in
Nitrogen_remerge<-merge(Nitrogen,dev,by="Date",all.x=TRUE)
Nitrogen_remerge<-Nitrogen_remerge[,c(1,3:5,7)]
Nitrogen_remerge<-na.omit(Nitrogen_remerge)
Nitrogen_remerge$Phelps_proportion<-Nitrogen_remerge$Phelps*0.51
Nitrogen_remerge$Whittier_proportion<-Nitrogen_remerge$Whittier*0.08
Nitrogen_remerge$Devereux_proportion<-Nitrogen_remerge$Devereux*0.42
Nitrogen_remerge$proportional_nutrients<-Nitrogen_remerge$Phelps_proportion+Nitrogen_remerge$Whittier_proportion+Nitrogen_remerge$Devereux_proportion
Nitrogen_remerge<-Nitrogen_remerge[Nitrogen_remerge$Venoco>=0,]
Nitrogen_remerge <- Nitrogen_remerge %>%
  mutate(
    rpd = (abs(proportional_nutrients-Venoco) / ((Venoco + proportional_nutrients) / 2)) * 100,
    direction = ifelse(proportional_nutrients>Venoco , "positive", "negative"),
    rpd = ifelse(direction == "negative", -rpd, rpd)
  ) %>%
  select(-direction)  # Optionally remove the direction column if not needed

mean(Nitrogen_remerge$rpd)
##119 percent removal of nitrogen

#Ammonia
Ammonia<- NCOS_All_A  %>%
  group_by(Datetime) %>%
  pivot_wider(names_from = Site, 
              values_from = Ammonia.um,
              values_fn = mean)

Ammonia<-as.data.frame(Ammonia)
#seperate out Devereux
dev<-Ammonia[,c(1,5)]
dev<-na.omit(dev)
dev$Date<-as.Date(dev$Datetime)
dev_daily<-aggregate(Devereux~Date,dev,FUN=mean)
#remove devereux samples
Ammonia<-Ammonia[,1:4]
Ammonia<-na.omit(Ammonia)
Ammonia$Date<-as.Date(Ammonia$Datetime)
#Bring Ammonia back in
Ammonia_remerge<-merge(Ammonia,dev,by="Date",all.x=TRUE)
Ammonia_remerge<-Ammonia_remerge[,c(1,3:5,7)]
Ammonia_remerge<-na.omit(Ammonia_remerge)
Ammonia_remerge$Phelps_proportion<-Ammonia_remerge$Phelps*0.51
Ammonia_remerge$Whittier_proportion<-Ammonia_remerge$Whittier*0.08
Ammonia_remerge$Devereux_proportion<-Ammonia_remerge$Devereux*0.42
Ammonia_remerge$proportional_nutrients<-Ammonia_remerge$Phelps_proportion+Ammonia_remerge$Whittier_proportion+Ammonia_remerge$Devereux_proportion
Ammonia_remerge <- Ammonia_remerge %>%
  mutate(
    rpd = (abs(proportional_nutrients-Venoco) / ((Venoco + proportional_nutrients) / 2)) * 100,
    direction = ifelse(proportional_nutrients>Venoco , "positive", "negative"),
    rpd = ifelse(direction == "negative", -rpd, rpd)
  ) %>%
  select(-direction)  # Optionally remove the direction column if not needed

mean(Ammonia_remerge$rpd)
##-22 percent removal of Ammonia
```

```{=html}
<table>


Nutrient       Relative Percent Difference   
-------------  ----------------------------   
Phosphate          37 %             
Nitrate          119 %            
Ammonia          -22 %               
</table>
```
**Table 2.** Relative percent difference in nutrients for Nitrogen, Phosphorus and Ammonia at NCOS

## Temporal Analysis

Analysis TBD.

```{r, echo=FALSE,warning=FALSE,message=FALSE}
#Upload and format old nutrient data from 2004-2011
old_Dev<-read.csv("Data/Nutrients/sbclter_stream_chemistry_allyears_non_registered_stations_20190628.csv")
old_Dev<-old_Dev[grepl("^DV", old_Dev$site_code), ]
old_Dev$Date<-as.Date(old_Dev$timestamp_local,format="%Y-%m-%dT%H:%M:%S")
old_Dev_m<-old_Dev[,c(3:5,13)]
colnames(old_Dev_m)<-c("Ammonia.um","Nitrite.Nitrate.um","Phosphate.um","Date")
old_Dev_m$Environment<-"Golf Course" #naming environment for later merging
old_Dev_rain<-merge(old_Dev_m,NOAA_Rain,by="Date")
old_Dev_rain$rain_cm<-old_Dev_rain$P_DAILY_CALC*0.1
old_Dev_rain<-old_Dev_rain[old_Dev_rain$Nitrite.Nitrate.um>=0&old_Dev_rain$Phosphate.um>=0,]

a <- plot_ly(old_Dev_rain, x = ~Date)
a <- a %>% add_trace(y = ~Ammonia.um,type='scatter',mode = 'markers',color="Ammonia")
a <- a %>% add_trace(y = ~Phosphate.um,type='scatter',mode = 'markers',color="Phosphate")
a <- a %>% add_trace(y = ~Nitrite.Nitrate.um,type='scatter',mode = 'markers',color="Nitrite")
a <- a %>% add_trace(y = ~rain_cm, name = 'Rain',type = 'bar',marker= list(color = 'rgb(158,202,225)',
                                                                           line = list(color = 'rgb(8,48,107)', width = 0.5)))
a
```

```{r, echo=FALSE,warning=FALSE,message=FALSE}

p <- plot_ly(NCOS_plusRain, x = ~Date)
p <- p %>% add_trace(y = ~Phosphate.um,type='scatter',mode = 'markers',color = ~Site)
p <- p %>% add_trace(y = ~rain_cm, name = 'Rain',type = 'bar',marker= list(color = 'rgb(158,202,225)',
                                                                           line = list(color = 'rgb(8,48,107)', width = 0.5)))
p
```

```{r, echo=FALSE,warning=FALSE,message=FALSE}
n <- plot_ly(NCOS_plusRain, x = ~Date)
n <- n %>% add_trace(y = ~Nitrite.Nitrate.um,type='scatter',mode = 'markers',color = ~Site)
n <- n %>% add_trace(y = ~rain_cm, name = 'Rain',type = 'bar',marker= list(color = 'rgb(158,202,225)',
                                                                           line = list(color = 'rgb(8,48,107)', width = 0.5)))
n

a <- plot_ly(NCOS_plusRain, x = ~Date)
a <- a %>% add_trace(y = ~Ammonia.um,type='scatter',mode = 'markers',color = ~Site)
a <- a %>% add_trace(y = ~rain_cm, name = 'Rain',type = 'bar',marker= list(color = 'rgb(158,202,225)',
                                                                      line = list(color = 'rgb(8,48,107)', width = 0.5)))
a
```
